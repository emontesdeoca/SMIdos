@model IEnumerable<ProyectoFinal.Models.RootObject>

@{
    ViewBag.Title = "Sala de Emergencias";
}
<h2>Sala de Emergencias</h2>

@*<h3>Pacientes entrantes</h3>*@
<div id="detailEmergency">
<table>
    <tr>
        <th>
            @Html.Label("Fecha")
        </th>
        <th>
            @Html.Label("Paciente")
        </th>
        <th>
            @Html.Label("Responsable")
        </th>
        <th>
            @Html.Label("Edad")
        </th>
        <th>
            @Html.Label("Sexo")
        </th>
        <th>
            @Html.Label("FC")
        </th>
        <th>
            @Html.Label("TA")
        </th>
        <th>
            @Html.Label("Alergias")
        </th>
        <th>
            @Html.Label("Nivel")
        </th>
        <th>
            @Html.Label("Posición")
        </th>
    </tr>

@foreach (var item in Model.OrderByDescending(a => a.modeloDatos.id).Take(2)) {
    <tr>
        <td>
            @item.modeloDatos.Fecha.dayOfMonth/@item.modeloDatos.Fecha.month/@item.modeloDatos.Fecha.year @item.modeloDatos.Fecha.hourOfDay:@item.modeloDatos.Fecha.minute:@item.modeloDatos.Fecha.second
        </td>
        <td>
            @item.modeloDatos.NombrePaciente
        </td>
        <td>
            @item.modeloDatos.NombreResponsable
        </td>
        <td>
            @item.modeloDatos.Edad
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.modeloDatos.Sexo)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.modeloExamen.Fc)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.modeloExamen.Ta)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.modeloMotivos.Alergias)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.modeloTrauma.Nivel)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.modeloTrauma.Posicion)
        </td>

@*        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.id }) |
            @Html.ActionLink("Details", "Details", new { id=item.id }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.id })
        </td>*@
    </tr>
}

</table>
    </div>

<head>
<script type="text/javascript">
    function ShowCurrentTime() {
        var dt = new Date();
        document.getElementById("lblTime").innerHTML = dt.toLocaleTimeString();
        setTimeout("ShowCurrentTime()", 1000); // Here 1000(milliseconds) means one 1 Sec
    }
</script>
</head>
<body onload="ShowCurrentTime()">
<div style="float:right; position:absolute; right:200px; top:100px">
<label id="lblTime" style=" font-weight:bold"></label>
</div>
</body>

@Scripts.Render("~/bundles/jquery") 
<div id="map_canvas" style="width: 740px; height: 360px;border-style:solid;border-width:2px;border-color:#808080;left:200px;margin-bottom:50px;
position:absolute;top:35%;left:22%;clear:both;float:right"> </div>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript"> 
    $(document).ready(function () { 
        initialize(); 
    }); 
    function initialize() {
        var latitud = "@ViewBag.Latitud";
        var longitud = "@ViewBag.Longitud";
        var UbicacionAmbulanciaUno = new google.maps.LatLng(latitud, longitud);
        var myLatlng = new google.maps.LatLng(18.467949, -69.909922);
        var latHospiten = new google.maps.LatLng(18.465092, -69.921041);
        var latUce = new google.maps.LatLng(18.471697, -69.912690);
        var latAbreu = new google.maps.LatLng(18.466974, -69.894987);
        var mapOptions = {
            center: myLatlng,
            zoom: 14,
            //mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var image = {
            url: 'http://maps.google.com/mapfiles/kml/pal4/icon55.png'
            // This marker is 20 pixels wide by 32 pixels tall.
            //size: new google.maps.Size(20, 32),
            // The origin for this image is 0,0.
            //origin: new google.maps.Point(0,0),
            // The anchor for this image is the base of the flagpole at 0,32.
            //anchor: new google.maps.Point(0, 32)
        };
        google.maps.visualRefresh = true;
        var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);
        //setMarkers(map, hospitales);

                // create a marker 
                //var latlng = new google.maps.LatLng(latitud, longitud);
                var marker1 = new google.maps.Marker({
                    position: latHospiten,
                    map: map,
                    icon: image,
                    title: 'HOSPITEN'
                });
                var marker2 = new google.maps.Marker({
                    position: latUce,
                    map: map,
                    icon: image,
                    title: 'UCE'
                });
                var marker3 = new google.maps.Marker({
                    position: latAbreu,
                    map: map,
                    icon: image,
                    title: 'ABREU'
                });
                var ambulanciaUno = new google.maps.Marker({
                    position: UbicacionAmbulanciaUno,
                    map: map,
                    title: 'Ambulancia A'
                });
    }
  //  var hospitales = [
  //['HOSPITEN', 18.465092, -69.921041],
  //['Coogee Beach', -33.923036, 151.259052, 5],
  //['Cronulla Beach', -34.028249, 151.157507, 3],
  //['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
  //['Maroubra Beach', -33.950198, 151.259302, 1]
  //  ];

  //  function setMarkers(map, locations) {
  //      // Add markers to the map

  //      // Marker sizes are expressed as a Size of X,Y
  //      // where the origin of the image (0,0) is located
  //      // in the top left of the image.

  //      // Origins, anchor positions and coordinates of the marker
  //      // increase in the X direction to the right and in
  //      // the Y direction down.
  //      var image = {
  //          url: '~/images/hospital.png',
  //          // This marker is 20 pixels wide by 32 pixels tall.
  //          size: new google.maps.Size(20, 32),
  //          // The origin for this image is 0,0.
  //          origin: new google.maps.Point(0, 0),
  //          // The anchor for this image is the base of the flagpole at 0,32.
  //          anchor: new google.maps.Point(0, 32)

           
  //      };
  //      // Shapes define the clickable region of the icon.
  //      // The type defines an HTML &lt;area&gt; element 'poly' which
  //      // traces out a polygon as a series of X,Y points. The final
  //      // coordinate closes the poly by connecting to the first
  //      // coordinate.
  //      var shape = {
  //          coord: [1, 1, 1, 20, 18, 20, 18, 1],
  //          type: 'poly'
  //      };
  //      for (var i = 0; i < locations.length; i++) {
  //          var hospital = locations[i];
  //          //var myLatLng = new google.maps.LatLng(hospital[1], hospital[2]);
  //          var marker = new google.maps.Marker({
  //              position: myLatLng,
  //              map: map,
  //              icon: image,
  //              shape: shape,
  //              title: hospital[0],
  //              zIndex: hospital[3]
  //          });
  //      }
  //  }
  //  google.maps.event.addDomListener(window, 'load', initialize);

</script>